---
phase: 11-analytics-export-and-categories
plan: 07
type: execute
depends_on: []
files_modified: [app/legal/privacy/page.tsx, app/legal/terms/page.tsx, lib/db/indexeddb.ts, lib/db/stores.ts]
---

<objective>
Create GDPR-compliant privacy policy and terms of service pages with acceptance tracking.

Purpose: Meet legal requirements for user data processing and establish clear terms of use.
Output: Privacy policy page, terms of service page, and policy acceptance tracking in user profiles.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@app/settings/export/page.tsx

**Tech stack available:** Next.js pages, user profiles in IndexedDB
**Established patterns:** Settings page layouts with headers and back buttons
**Current state:** Data export exists (GDPR Article 20), but no privacy policy or terms
**GDPR requirements:** Privacy policy must cover: data collected, processing purpose, retention, user rights (access, rectification, erasure, portability), contact information
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create privacy policy page</name>
  <files>app/legal/privacy/page.tsx</files>
  <action>Create /legal/privacy page with GDPR-compliant privacy policy. Include sections: 1) Introduction, 2) Data We Collect (expense details, participant names, email for auth), 3) How We Use Data (expense splitting, balance calculation, offline sync), 4) Data Storage (IndexedDB local storage, Supabase cloud sync), 5) Your Rights (access via export, rectification via edit, erasure via account deletion, portability via CSV export), 6) Data Retention (kept until account deletion or 3 years of inactivity), 7) Contact (support email). Use clear, simple language (no legalese). Style with iOS-native typography, proper spacing, and dark mode. Add "Last updated: [date]" at top. Link to terms of service at bottom.</action>
  <verify>Privacy policy page loads at /legal/privacy, all sections present, readable on mobile, dark mode works, links functional</verify>
  <done>Privacy policy page with GDPR-compliant content and iOS-native styling</done>
</task>

<task type="auto">
  <name>Task 2: Create terms of service page</name>
  <files>app/legal/terms/page.tsx</files>
  <action>Create /legal/terms page with terms of service. Include sections: 1) Acceptance of Terms, 2) Service Description (expense splitting PWA), 3) User Accounts (registration via magic link, account security), 4) Acceptable Use (no illegal activity, no service abuse), 5) Intellectual Property (Splitwiser owns the code, users own their data), 6) Limitation of Liability (service provided "as-is", no financial advice), 7) Changes to Terms (notify via email), 8) Termination (user can delete account anytime), 9) Contact. Use simple language. Style matches privacy policy page. Add "Last updated: [date]" at top. Link to privacy policy.</action>
  <verify>Terms page loads at /legal/terms, all sections present, readable, dark mode works, links functional</verify>
  <done>Terms of service page with clear terms and iOS-native styling</done>
</task>

<task type="auto">
  <name>Task 3: Add policy acceptance tracking</name>
  <files>lib/db/indexeddb.ts, lib/db/stores.ts</files>
  <action>Add fields to user profiles: privacy_policy_accepted_at (timestamp), terms_accepted_at (timestamp), policy_version (string, e.g., "1.0"). Update createUserProfile() to not require acceptance (for existing users). Create acceptPolicies(userId, version) function that updates timestamps. On signup flow (auth/callback), show policy acceptance screen if not accepted: checkbox "I have read and accept the Privacy Policy and Terms of Service" with links to /legal/privacy and /legal/terms. Require acceptance before completing registration. Store acceptance timestamp and version. For existing users, show one-time banner on app load if not accepted (dismissible, but persists until accepted).</action>
  <verify>User profile schema includes policy acceptance fields, acceptPolicies() function works, signup flow shows acceptance screen, existing users see banner</verify>
  <done>Policy acceptance tracking implemented with signup integration and existing user notification</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Privacy policy page loads at /legal/privacy
- [ ] Terms of service page loads at /legal/terms
- [ ] Both pages readable, well-formatted, dark mode works
- [ ] Policy acceptance fields added to user profiles
- [ ] Signup flow requires policy acceptance
- [ ] Links to legal pages functional
</verification>

<success_criteria>

- All tasks completed
- GDPR-compliant privacy policy published
- Clear terms of service published
- Policy acceptance tracked for all users
- iOS-native styling maintained
</success_criteria>

<output>
After completion, create `.planning/phases/11-analytics-export-and-categories/11-07-SUMMARY.md`
</output>